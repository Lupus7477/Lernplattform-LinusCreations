<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ“ Lokale Lernplattform</title>
    <link rel="stylesheet" href="/css/style.css">
    <!-- Marked.js fÃ¼r Markdown-Rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Highlight.js fÃ¼r Code-Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11"></script>
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-brand">
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="MenÃ¼">â˜°</button>
                <span class="logo">ğŸ“</span>
                <h1>Lernplattform</h1>
            </div>
            <div class="header-status">
                <span id="llm-status" class="status-badge status-checking">
                    ğŸ¤– PrÃ¼fe LLM...
                </span>
            </div>
        </header>

        <!-- Sidebar Overlay fÃ¼r Mobile -->
        <div class="sidebar-overlay" onclick="closeMobileMenu()"></div>

        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <ul class="nav-list">
                <li class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span class="nav-text">Dashboard</span>
                </li>
                <li class="nav-item" data-view="documents">
                    <span class="nav-icon">ğŸ“š</span>
                    <span class="nav-text">Dokumente</span>
                </li>
                <li class="nav-item" data-view="study-plan">
                    <span class="nav-icon">ğŸ“…</span>
                    <span class="nav-text">Lernplan</span>
                </li>
                <li class="nav-item" data-view="learn">
                    <span class="nav-icon">ğŸ“–</span>
                    <span class="nav-text">Lernen</span>
                </li>
                <li class="nav-item" data-view="quiz">
                    <span class="nav-icon">â“</span>
                    <span class="nav-text">Quiz</span>
                </li>
                <li class="nav-item" data-view="chat">
                    <span class="nav-icon">ğŸ’¬</span>
                    <span class="nav-text">Chat</span>
                </li>
                <li class="nav-item" data-view="glossary">
                    <span class="nav-icon">ğŸ“–</span>
                    <span class="nav-text">Glossar</span>
                </li>
                <li class="nav-item" data-view="settings">
                    <span class="nav-icon">âš™ï¸</span>
                    <span class="nav-text">Einstellungen</span>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <section id="view-dashboard" class="view active">
                <h2>Dashboard</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“š</div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-documents">0</span>
                            <span class="stat-label">Dokumente</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ“…</div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-days">-</span>
                            <span class="stat-label">Tage bis PrÃ¼fung</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-progress">0%</span>
                            <span class="stat-label">Fortschritt</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ¯</div>
                        <div class="stat-info">
                            <span class="stat-value" id="stat-score">-</span>
                            <span class="stat-label">Durchschnitt</span>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="card">
                        <h3>ğŸ“ˆ Lernfortschritt</h3>
                        <div class="progress-overview" id="progress-overview">
                            <p class="placeholder">Starte einen Lernplan, um deinen Fortschritt zu sehen.</p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>ğŸ“‹ NÃ¤chste Schritte</h3>
                        <div id="next-steps">
                            <ol class="steps-list">
                                <li id="step-1" class="step pending">
                                    <span class="step-icon">1</span>
                                    <span>Dokumente hochladen</span>
                                </li>
                                <li id="step-2" class="step pending">
                                    <span class="step-icon">2</span>
                                    <span>PrÃ¼fungstermin festlegen</span>
                                </li>
                                <li id="step-3" class="step pending">
                                    <span class="step-icon">3</span>
                                    <span>Lernplan erstellen</span>
                                </li>
                                <li id="step-4" class="step pending">
                                    <span class="step-icon">4</span>
                                    <span>Mit dem Lernen beginnen</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Documents View -->
            <section id="view-documents" class="view">
                <h2>ğŸ“š Dokumente</h2>
                
                <div class="card">
                    <h3>Dokumente hochladen</h3>
                    <div class="upload-area" id="upload-area">
                        <input type="file" id="file-input" accept=".pdf" multiple hidden>
                        <div class="upload-content">
                            <span class="upload-icon">ğŸ“„</span>
                            <p>PDF-Dateien hier ablegen oder klicken zum AuswÃ¤hlen</p>
                        </div>
                    </div>
                    <button class="btn btn-secondary" id="scan-folder-btn">
                        ğŸ“ Ordner scannen
                    </button>
                </div>

                <div class="card">
                    <h3>Hochgeladene Dokumente</h3>
                    <div id="documents-list" class="documents-list">
                        <p class="placeholder">Noch keine Dokumente hochgeladen.</p>
                    </div>
                </div>
            </section>

            <!-- Study Plan View -->
            <section id="view-study-plan" class="view">
                <h2>ğŸ“… Lernplan</h2>
                
                <div id="no-plan" class="card">
                    <h3>Neuen Lernplan erstellen</h3>
                    <form id="create-plan-form">
                        <div class="form-group">
                            <label for="exam-date">PrÃ¼fungsdatum:</label>
                            <input type="date" id="exam-date" required>
                        </div>
                        <div class="form-group">
                            <label>Dokumente auswÃ¤hlen:</label>
                            <div id="plan-documents" class="checkbox-list">
                                <p class="placeholder">Lade zuerst Dokumente hoch.</p>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="create-plan-btn">
                            ğŸš€ Lernplan erstellen
                        </button>
                    </form>
                </div>

                <div id="active-plan" class="hidden">
                    <div class="card plan-header">
                        <h3 id="plan-name">Lernplan</h3>
                        <div class="plan-meta">
                            <span>ğŸ“… PrÃ¼fung: <strong id="plan-exam-date"></strong></span>
                            <span>â±ï¸ Noch <strong id="plan-days-left"></strong> Tage</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="plan-progress-bar"></div>
                        </div>
                        <span class="progress-text"><span id="plan-progress">0</span>% abgeschlossen</span>
                    </div>

                    <div class="card">
                        <h3>ğŸ“‹ ThemenÃ¼bersicht</h3>
                        <div id="topics-list" class="topics-list"></div>
                    </div>
                </div>
            </section>

            <!-- Learn View -->
            <section id="view-learn" class="view">
                <h2>ğŸ“– Lernen</h2>
                
                <div id="learn-select-topic" class="card">
                    <h3>WÃ¤hle ein Thema zum Lernen</h3>
                    <div id="learn-topics" class="topics-grid"></div>
                </div>

                <div id="learn-content" class="hidden">
                    <div class="card">
                        <div class="learn-header">
                            <button class="btn btn-secondary" id="back-to-topics">
                                â† ZurÃ¼ck
                            </button>
                            <h3 id="learn-topic-title"></h3>
                        </div>
                        <div id="explanation-content" class="explanation markdown-body">
                            <!-- Skeleton Loading -->
                            <div class="skeleton-container">
                                <div class="skeleton skeleton-title"></div>
                                <div class="skeleton skeleton-text"></div>
                                <div class="skeleton skeleton-text"></div>
                                <div class="skeleton skeleton-text short"></div>
                                <div class="skeleton skeleton-title" style="margin-top: 24px;"></div>
                                <div class="skeleton skeleton-text"></div>
                                <div class="skeleton skeleton-text"></div>
                            </div>
                        </div>
                        <div class="learn-actions">
                            <button class="btn btn-primary" id="start-quiz-btn">
                                â“ Zu den Fragen
                            </button>
                            <button class="btn btn-secondary" id="mark-complete-btn">
                                âœ… Als gelernt markieren
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quiz View -->
            <section id="view-quiz" class="view">
                <h2>â“ Quiz</h2>
                
                <div id="quiz-select" class="card">
                    <h3>Thema auswÃ¤hlen</h3>
                    <div id="quiz-topics" class="topics-grid"></div>
                    <div class="form-group">
                        <label for="difficulty-select">Schwierigkeitsgrad:</label>
                        <select id="difficulty-select">
                            <option value="1">1 - Einfach</option>
                            <option value="2">2 - Grundlegend</option>
                            <option value="3" selected>3 - Mittel</option>
                            <option value="4">4 - Fortgeschritten</option>
                            <option value="5">5 - Schwer</option>
                        </select>
                    </div>
                </div>

                <div id="quiz-active" class="hidden">
                    <div class="card quiz-card">
                        <div class="quiz-header">
                            <span class="quiz-progress">Frage <span id="quiz-current">1</span> von <span id="quiz-total">3</span></span>
                            <span class="quiz-difficulty" id="quiz-difficulty">â­â­â­</span>
                        </div>
                        
                        <div class="question-content">
                            <p id="question-text" class="question-text"></p>
                            <div id="question-hints" class="hints hidden">
                                <button class="btn btn-hint" id="show-hint-btn">ğŸ’¡ Hinweis anzeigen</button>
                                <p id="hint-text" class="hint-text hidden"></p>
                            </div>
                        </div>

                        <div class="answer-section">
                            <textarea id="answer-input" placeholder="Deine Antwort..." rows="4"></textarea>
                            <button class="btn btn-primary" id="submit-answer-btn">
                                Antwort absenden
                            </button>
                        </div>

                        <div id="feedback-section" class="feedback hidden">
                            <div class="feedback-header">
                                <span id="feedback-icon"></span>
                                <span id="feedback-status"></span>
                            </div>
                            <p id="feedback-text"></p>
                            <div id="expected-answer" class="expected-answer"></div>
                            <button class="btn btn-primary" id="next-question-btn">
                                NÃ¤chste Frage â†’
                            </button>
                        </div>
                    </div>
                </div>

                <div id="quiz-results" class="hidden">
                    <div class="card results-card">
                        <h3>ğŸ† Quiz abgeschlossen!</h3>
                        <div class="results-stats">
                            <div class="result-stat">
                                <span class="result-value" id="result-correct">0</span>
                                <span class="result-label">Richtig</span>
                            </div>
                            <div class="result-stat">
                                <span class="result-value" id="result-total">0</span>
                                <span class="result-label">Gesamt</span>
                            </div>
                            <div class="result-stat">
                                <span class="result-value" id="result-percent">0%</span>
                                <span class="result-label">Erfolgsrate</span>
                            </div>
                        </div>
                        <div class="results-actions">
                            <button class="btn btn-primary" id="retry-quiz-btn">
                                ğŸ”„ Nochmal versuchen
                            </button>
                            <button class="btn btn-secondary" id="new-quiz-btn">
                                ğŸ“ Neues Quiz
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Chat View -->
            <section id="view-chat" class="view">
                <h2>ğŸ’¬ Lern-Chat</h2>
                
                <div class="chat-container">
                    <div class="chat-header">
                        <select id="chat-topic-select">
                            <option value="">Allgemein</option>
                        </select>
                    </div>
                    
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-message assistant">
                            <div class="message-content">
                                ğŸ‘‹ Hallo! Ich bin dein Lernassistent. Stelle mir Fragen zu deinen Lernmaterialien und ich helfe dir beim Verstehen.
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-area">
                        <textarea id="chat-input" placeholder="Stelle eine Frage..." rows="2"></textarea>
                        <button class="btn btn-primary" id="send-chat-btn">
                            Senden
                        </button>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="view-settings" class="view">
                <h2>âš™ï¸ Einstellungen</h2>
                
                <div class="card">
                    <h3>ğŸ® Quiz-Einstellungen</h3>
                    <div class="form-group">
                        <label for="questions-count">Anzahl Fragen pro Quiz:</label>
                        <select id="questions-count">
                            <option value="3">3 Fragen (Schnell)</option>
                            <option value="5" selected>5 Fragen (Standard)</option>
                            <option value="7">7 Fragen (AusfÃ¼hrlich)</option>
                            <option value="10">10 Fragen (Intensiv)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="repeat-wrong-questions" checked>
                            Falsche Fragen am Ende wiederholen
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="gamification-enabled" checked>
                            ğŸ® Gamification aktivieren (Punkte, Streaks, Achievements)
                        </label>
                    </div>
                </div>
                
                <div class="card">
                    <h3>ğŸ¤– LLM-Konfiguration</h3>
                    <p id="current-model-info" class="model-info">Aktuell: Wird geladen...</p>
                    <div class="form-group">
                        <label for="model-select">Modell auswÃ¤hlen (Ã„nderung wird sofort Ã¼bernommen):</label>
                        <select id="model-select">
                            <option value="">Wird geladen...</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" id="refresh-models-btn">
                        ğŸ”„ Modelle neu laden
                    </button>
                    <p class="hint-text" style="margin-top: 10px; font-size: 13px; color: #666;">
                        ğŸ’¡ Tipp: Stelle sicher, dass Ollama lÃ¤uft und das gewÃ¼nschte Modell heruntergeladen ist.<br>
                        Installiere neue Modelle mit: <code>ollama pull &lt;modellname&gt;</code>
                    </p>
                </div>

                <div class="card">
                    <h3>ğŸ“ Dokumenten-Ordner</h3>
                    <div class="form-group">
                        <label for="docs-path">Pfad zu den Lernmaterialien:</label>
                        <input type="text" id="docs-path" placeholder="C:\Users\...">
                    </div>
                </div>

                <div class="card">
                    <h3>â„¹ï¸ Ãœber diese Anwendung</h3>
                    <p>
                        Diese Lernplattform lÃ¤uft <strong>vollstÃ¤ndig lokal</strong> auf deinem Computer.
                        Keine Daten werden an externe Server gesendet.
                    </p>
                    <p>
                        <strong>Technologie:</strong> Go Backend, Ollama LLM, SQLite Datenbank
                    </p>
                </div>
            </section>

            <!-- Glossar View -->
            <section id="view-glossary" class="view">
                <h2>ğŸ“– Glossar</h2>
                
                <div class="card">
                    <div class="glossary-header">
                        <div class="search-box">
                            <input type="text" id="glossary-search" placeholder="ğŸ” Begriff suchen...">
                        </div>
                        <button class="btn btn-primary" id="add-glossary-btn">
                            â• Neuer Begriff
                        </button>
                    </div>
                    
                    <div class="glossary-filters">
                        <button class="filter-btn active" data-filter="all">Alle</button>
                        <button class="filter-btn" data-filter="definition">Definitionen</button>
                        <button class="filter-btn" data-filter="formula">Formeln</button>
                        <button class="filter-btn" data-filter="concept">Konzepte</button>
                    </div>
                </div>

                <div id="glossary-list" class="glossary-list">
                    <!-- Skeleton Loading -->
                    <div class="glossary-skeleton">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                    </div>
                    <div class="glossary-skeleton">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text short"></div>
                    </div>
                </div>

                <!-- Add/Edit Glossary Modal -->
                <div id="glossary-modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="modal-title">Neuer Glossar-Eintrag</h3>
                            <button class="modal-close" id="close-modal">&times;</button>
                        </div>
                        <form id="glossary-form">
                            <div class="form-group">
                                <label for="glossary-term">Begriff *</label>
                                <input type="text" id="glossary-term" required placeholder="z.B. Supply Chain Management">
                            </div>
                            <div class="form-group">
                                <label for="glossary-category">Kategorie</label>
                                <select id="glossary-category">
                                    <option value="definition">Definition</option>
                                    <option value="formula">Formel</option>
                                    <option value="concept">Konzept</option>
                                    <option value="abbreviation">AbkÃ¼rzung</option>
                                    <option value="other">Sonstiges</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="glossary-definition">Beschreibung *</label>
                                <textarea id="glossary-definition" rows="4" required placeholder="Kurze, prÃ¤gnante ErklÃ¤rung..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="glossary-details">Weitere Details (optional)</label>
                                <textarea id="glossary-details" rows="3" placeholder="Beispiele, Formeln, ZusammenhÃ¤nge..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="glossary-related">Verwandte Begriffe (kommagetrennt)</label>
                                <input type="text" id="glossary-related" placeholder="z.B. Logistik, Beschaffung">
                            </div>
                            <div class="modal-actions">
                                <button type="button" class="btn btn-secondary" id="cancel-glossary">Abbrechen</button>
                                <button type="submit" class="btn btn-primary">ğŸ’¾ Speichern</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
